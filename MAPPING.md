# Correspondance des champs "Liste de choix"

## Geotrek:Trek – Apidae:Équipement

| Libellé Geotrek | Nom système | Libellé Apidae | Nom système | Remarques |
|:--|:--|:--|:--|:--|
| Difficulté | `difficulty` | Complément accueil | `prestations.complementAccueil` | Les valeurs Geotrek sont écrites en texte dans Apidae, cf. [https://geotrek.ecrins-parcnational.fr/ressources/technique/2022-04-Geotrek-Apidae-v2.pdf](https://geotrek.ecrins-parcnational.fr/ressources/technique/2022-04-Geotrek-Apidae-v2.pdf) |
| Difficulté | `difficulty` | Types de clientèle | `prestations.typesClientele` | Une correspondance suivant le niveau de difficulté Geotrek est faite avec les éléments de références Apidae de type TypeClientele  |
| Pratique | `practice` | Types d'activité / d'équipement | `informationsEquipement.activites` | Correspondance définie dans la configuration de la passerelle, pour l'instance/la structure Geotrek souhaitée. Valeurs Apidae : [/config/apidae/equipement_activity.json](https://github.com/GeotrekCE/Sitourisme/blob/main/config/apidae/equipement_activity.json) |
| Parcours | `route` | Type d'itinéraire | `informationsEquipement.itineraire.itineraireType` | Correspondance définie dans la configuration de la passerelle, pour l'instance/la structure Geotrek souhaitée. Valeurs Apidae : **BOUCLE**, **ALLER_RETOUR**, **ALLER_ITINERANCE** |
| Thèmes | `themes` | Critères internes | `critères internes` | EVO 5.2 via le fichier de configuration des instances, il est possible d'ajouter un mapping entre les thèmes Geotrek et les critères internes Apidae |
| Étiquettes | `labels` | Descriptifs thématisés / Conseils et suggestions  | `presentation.descriptifsThematises`  |  |
| Réseaux | `networks` | Précisions balisage | `informationsEquipement.itineraire.precisionsBalisage` | Les valeurs Geotrek sont écrites en texte dans Apidae, séparées par des tirets. Certaines valeurs sont réécrites : **PR → Balisage Petite Randonnée**, **GR → Balisage Grande Randonnée**, **GRP → Balisage Grande Randonnée de Pays**, **VTT → Balisage VTT** |
| Lien web | `web_links` | *Non repris* |  |  |
| Lieu de renseignement → Rue | `information_desks` (référence) → `street` | Adresse | `localisation.adresse` | Les coordonnées du lieu de renseignement sont réparties dans plusieurs champs de la fiche Apidae. |
| Lieu de renseignement → Site web | `information_desks` (référence) → `website` | Moyens de communication | `informations.moyensCommunication` | Les coordonnées du lieu de renseignement sont réparties dans plusieurs champs de la fiche Apidae. |
| Lieu de renseignement → Courriel | `information_desks` (référence) → `email` | Moyens de communication | `informations.moyensCommunication` | Les coordonnées du lieu de renseignement sont réparties dans plusieurs champs de la fiche Apidae. |
| Lieu de renseignement → Téléphone | `information_desks` (référence) → `phone` | Moyens de communication | `informations.moyensCommunication` | Les coordonnées du lieu de renseignement sont réparties dans plusieurs champs de la fiche Apidae. |
| Source | `source` | *Non repris* |  |  |
| Portail | `portal` | *Non repris* |  |  |
| Enfant | `children` ? | *Non repris* |  |  |
| Système de réservation | `reservation_system` | *Non repris* |  |  |
| Itinéraires liés | ? | *Non repris* |  |  |
| Type d'accessibilité | `accessibilities` | *Non repris* |  |  |
| Niveau d'accessibilité | `accessibility_level` | *Non repris* |  |  |
| Coordonnées | `departure_geom` | Géolocalisation | `localisation.geolocalisation.geoJson.coordinates` | Les coordonnées Geotrek sont issues du champ departure_geom quand celui-ci est renseigné, sinon du champ parking_location |
| Chapeau | `description_teaser` | Description courte | `presentation.descriptifCourt`  | |
| Ambiance | `ambiance` | Description détaillé | `presentation.descriptifDetaille`  | |
| Description | `description` | Descriptifs thématisés / Topo/pas à pas  | `presentation.descriptifsThematises`  |  |
| Recommandations | `advice` | Descriptifs thématisés / Conseils et suggestions  | `presentation.descriptifsThematises`  |  |
| Etiquettes | `labels` | Descriptifs thématisés / Conseils et suggestions  | `presentation.descriptifsThematises`  | Ici est retourné le(s) id(s) des labels. Les labels sont disonible sur  /api/v2/label ou :api/label/{id}. Le texte des éventuelles étiquettes sera concaténé aux recommandations et aura la forme suivant "Nom de l'étiquette : Texte de l'étiquette nettoyé". Il peut y avoir du contenu HTML, s'il y a des images ou photos, elles ne seront alors pas prises en compte dans l'import/ - EVO 5.2 via le fichier de configuration des instances, il est possible d'ajouter un mapping entre les labels Geotrek et les critères internes Apidae|
| Geotrek-trek-id | `id` | ??? | ???  | Le but est de récupérer l'id de l'itinéraire au sein du Geotrek pour pouvoir l'appeler depuis l'API Geotrek via le widget ou sur une page d'un OT |
| Geotrek-api-url | `url` | ??? | ???  | Il est aussi possible de récupérer l'id et l'url en parsant ce champ. L'idée est la même que ci-dessus pour l'id |
| Lieu de départ | `departure` | Complément localisation | `geoLocalization.complement`  | 'Lieu de départ : ' (FR/EN/IT/ES/DE/NL) + departure  |
| Lieu d'arrivée | `arrival` | Complément localisation | `geoLocalization.complement`  | 'Lieu d'arrivée : ' (FR/EN/IT/ES/DE/NL) + arrival  |
| Accès routier | `access` | Complément localisation | `geoLocalization.complement`  | 'Accès routier' : ' (FR/EN/IT/ES/DE/NL) + access  |
| Parking conseillé | `advised_parking` | Complément localisation | `geoLocalization.complement`  | 'Parking conseillé' : ' (FR/EN/IT/ES/DE/NL) + advised_parking  |
| Transports en commun | `public_transport` | Complément localisation | `geoLocalization.complement`  | 'Transports en commun' : ' (FR/EN/IT/ES/DE/NL) + public_transport  |
| Tracé KML | `kml` | Multimédia  | `multimedia.plan`  | Plans et tracés GPS, en lien (.KML) |
| Tracé GPX | `gpx` | Multimédia  | `multimedia.plan`  | Plans et tracés GPS hébergés sur Apidae (.GPX + carte)  |

## Geotrek:Touristicevent → Apidae:Fête et manifestation (Mapping des champs)

| Champ Geotrek          | Sous-champ     | Objet JS / Mongo                                               | Valeur / Format               | Champ Apidae                                                           | Notes Apidae                                                                                      |
|------------------------|----------------|------------------------------------------------------------------|-------------------------------|------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| *(global)*             |                | `importType`                                                    | `GEOTREK-API`                | –                                                                      | –                                                                                                 |
|                        |                | `importSubType`                                                 | –                            | `informations.structureGestion`                                         | –                                                                                                 |
|                        |                | `typeCode`                                                      | `F&M`                        | –                                                                      | –                                                                                                 |
|                        |                | `type`                                                          | `FETE_ET_MANIFESTATION`      | `type`                                                                 | –                                                                                                 |
|                        |                | `state`                                                         | `HIDDEN`                     | `state`                                                                | Peut être `NEW` aussi                                                                             |
|                        |                | `statusImport`                                                  | –                            | –                                                                      | –                                                                                                 |
|                        |                | `member`, `proprietaireId`                                      | –                            | `gestion.membreProprietaire`                                            | –                                                                                                 |
|                        |                | `user`                                                          | –                            | –                                                                      | –                                                                                                 |
|                        |                | `scope`                                                         | `2352`                       | `informationsFeteEtManifestation.portee`                              | –                                                                                                 |
|                        |                | `linkedObject`                                                  | –                            | –                                                                      | –                                                                                                 |
|                        |                | `oldSpecialIdSitra`                                             | –                            | –                                                                      | –                                                                                                 |
|                        |                | `alert`                                                         | –                            | –                                                                      | Blocage si code postal manquant                                                                  |
|                        |                | `rateCompletion`                                                | –                            | –                                                                      | –                                                                                                 |
|                        |                | `territory`                                                     | –                            | `territoires`                                                          | Calculé                                                                                           |
|                        |                | `specialIdSitra`                                                | –                            | `ID`                                                                   | –                                                                                                 |
| `create_datetime`      |                | `created`                                                       | `Now`                        | `gestion.dateCreation`                                                | Calculé côté Apidae                                                                               |
| `update_datetime`      |                | `lastUpdate`                                                    | `Now`                        | `dateModification`, `dateExportModification`                          | –                                                                                                 |
| `id`                   |                | `specialId`                                                     | –                            | –                                                                      | –                                                                                                 |
| `accessibility`        |                | –                                                               | –                            | `prestations.complementAccueil`                                       | “Accessibilité : …”                                                                               |
| `approved`             |                | –                                                               | –                            | –                                                                      | –                                                                                                 |
| `attachments`          |                | `image`                                                         | –                            | `illustrations`                                                        | –                                                                                                 |
|                        | `author`       | `image.description`                                             | –                            | `illustrations.copyright`                                              | –                                                                                                 |
|                        | `legend`       | `image.legend`                                                  | –                            | `illustrations.legend`                                                 | –                                                                                                 |
|                        | `title`        | `image.title`                                                   | –                            | `illustrations.nom`                                                    | Pas de champ `multimedia.title`                                                                   |
|                        | `url`          | `image.url`                                                     | –                            | `illustrations.traductionFichiers.url`                                 | –                                                                                                 |
| `begin_date`           |                | `openingDate.periodesOuvertures.dateStart`                      | `2023-12-31`                 | `ouverture.periodesOuvertures.dateDebut`                               | –                                                                                                 |
| `booking`              |                | `reservation.complementFr`                                      | –                            | `reservation.complement`                                               | Passage en UTF8                                                                                    |
| `cancelled`            |                | –                                                               | –                            | –                                                                      | Dépublication manuelle dans Geotrek                                                               |
| `capacity`             |                | `prestations.tailleGroupeMax`                                   | –                            | `informationsFeteEtManifestation.nbParticipantsAttendu`, `nbVisiteursAttendu` | –                                                                                                 |
| `city_codes`           |                | `perimetreGeo`, `address.insee`…                                | –                            | `localisation.commune`                                 | Lorsque l'information localisation.lieu n'est pas définie, le champ Geotrek Cities permet de renseigner la commune.                                                                                                  |
| `description`          |                | `description` + langues                                         | –                            | `presentation.descriptifDetaille`                                      | –                                                                                                 |
| `description_teaser`   |                | `shortDescription` + langues                                    | –                            | `presentation.descriptifCourt`                                         | –                                                                                                 |
| `districts`            |                | `district`                                                      | –                            | `informations.structureGestion`, `informations.structureInformation`   | Les correspondances entre districts Geotrek & les entités Apidae sont définies dans configImport_Geotrek:geotrekInstance.id_instance.touristicevent_districtToEntities, si le district n'est pas renseigné ou ne comporte pas de correspondances, l'entité par défaut est utilisée, définie configImport_Geotrek:geotrekInstance.id_instance.touristicevent_defaultEntity. Le numéro de téléphone à importer dans informations.moyensCommunication est également défini via ces correspondances.                                                                                                  |
| `duration`             |                | `dureeSeance`                                                   | –                            | `ouverture.dureeSeance`                                                | –                                                                                                 |
| `email`                |                | `email`                                                         | –                            | `informations.moyensCommunication`                                    | –                                                                                                 |
| `end_date`             |                | `openingDate.periodesOuvertures.dateEnd`, `expiration.dateExpiration` | `2023-12-31`                 | `ouverture.periodesOuvertures.dateFin`                                 | Masquage automatique                                                                              |
| `end_time`             |                | `ouverture.periodesOuvertures.horaireFermeture`                | `0:30:00`                    | –                                                                      | –                                                                                                 |
| `geometry.coordinates` |           | `localization.lat`, `lon`                                       | –                            | `localisation.geolocalisation.geoJson.coordinates`                    | –                                                                                                 |
| `meeting_point`  |                | `complementAccueil`                                             | –                            | `prestations.complementAccueil`                                       | “Point de rendez-vous : …”                                                                        |
| `name`           |                | `name` + langues                                                | –                            | `nom`                                                                  | –                                                                                                 |
| `organizer`      |                | `complementAccueil`                                             | –                            | `prestations.complementAccueil`                                       | “Organisateur : …”                                                                                |
| `pdf`            |                | `pdf` + langues                                                 | –                            | `multimedias.traductionFichiers`                                     | –                                                                                                 |
| `place`          |                | `complementAccueil`                                             | –                            | `prestations.complementAccueil`, `localisation.lieu` (EVO 3.4)         | –                                                                                                 |
| `practical_info` |                | `complementAccueil`                                             | –                            | `prestations.complementAccueil`                                       | “Informations pratiques : …”                                                                      |
| `speaker`        |                | `description`                                                   | –                            | `presentation.descriptifDetaille`                                      | “Intervenant : …”                                                                                 |
| `start_time`     |                | `ouverture.periodesOuvertures.horaireOuverture`                | `10:00:00`                   | –                                                                      | –                                                                                                 |
| `target_audience` |                | `description`                                                   | –                            | `presentation.descriptifDetaille`, `prestations.typesClientele`       | “Public : …”                                                                                       |
| `type`           |                | `activity`                                                      | –                            | `informationsFeteEtManifestation.categories`                          | –                                                                                                 |
| `url`            |                | `url`                                                           | –                            | `liens.complement`                                                    | –                                                                                                 |
| `website`        |                | `website`                                                       | –                            | `informations.moyensCommunication`                                    | –                                                                                                 |
